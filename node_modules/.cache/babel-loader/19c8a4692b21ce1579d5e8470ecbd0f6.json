{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"/home/captainspring/Desktop/code/WebSocket/myproject/clientx/src/Components/ChatBoxWrap/ChatBoxWrap.js\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState } from 'react';\nimport ChatBox from './../ChatBox/index';\nimport { DO_WE_NEED_RENDER } from './../../Config/index';\nimport { useHistory, useParams } from 'react-router-dom';\n\nconst ChatBoxWrap = () => {\n  _s();\n\n  const [userroom, setUserroom] = useState(['', '', false]);\n  const history = useHistory();\n  const params = useParams();\n\n  const checkValidate = async () => {\n    await fetch(DO_WE_NEED_RENDER, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n        'authorization-user': `Bear ${localStorage.getItem('token_user')}`,\n        'authorization-room': `Bear ${localStorage.getItem('token_room')}`\n      },\n      body: JSON.stringify({\n        room: params.room\n      })\n    }).then(res => {\n      if (res.status === 403) {\n        history.replace('/login');\n        return;\n      }\n\n      return res.json();\n    }).then(rs => {\n      setUserroom([rs.username, rs.room, true]);\n    }, err => console.log(err)).catch(err => console.log(err));\n  };\n\n  useEffect(() => {\n    if (!localStorage.getItem('token_user')) {\n      history.replaceState('/login');\n      return;\n    }\n\n    if (!localStorage.getItem('token_room')) {\n      history.replaceState('/room');\n      return;\n    }\n\n    checkValidate();\n  });\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: userroom[2] === true ? /*#__PURE__*/_jsxDEV(ChatBox, {\n      userroom: userroom\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 57,\n      columnNumber: 5\n    }, this) : /*#__PURE__*/_jsxDEV(\"h1\", {\n      children: \"Loading.....\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 59,\n      columnNumber: 5\n    }, this)\n  }, void 0, false);\n};\n\n_s(ChatBoxWrap, \"PjW2HUuM8fLa3vLi9ltufLRWyis=\", false, function () {\n  return [useHistory, useParams];\n});\n\n_c = ChatBoxWrap;\nexport default ChatBoxWrap;\n\nvar _c;\n\n$RefreshReg$(_c, \"ChatBoxWrap\");","map":{"version":3,"sources":["/home/captainspring/Desktop/code/WebSocket/myproject/clientx/src/Components/ChatBoxWrap/ChatBoxWrap.js"],"names":["React","useEffect","useState","ChatBox","DO_WE_NEED_RENDER","useHistory","useParams","ChatBoxWrap","userroom","setUserroom","history","params","checkValidate","fetch","method","headers","localStorage","getItem","body","JSON","stringify","room","then","res","status","replace","json","rs","username","err","console","log","catch","replaceState"],"mappings":";;;;;;AAAA,OAAOA,KAAP,IAAgBC,SAAhB,EAA2BC,QAA3B,QAA2C,OAA3C;AACA,OAAOC,OAAP,MAAoB,oBAApB;AACA,SAASC,iBAAT,QAAkC,sBAAlC;AACA,SAASC,UAAT,EAAqBC,SAArB,QAAsC,kBAAtC;;AAEA,MAAMC,WAAW,GAAG,MAAM;AAAA;;AACzB,QAAM,CAACC,QAAD,EAAWC,WAAX,IAA0BP,QAAQ,CAAC,CAAC,EAAD,EAAK,EAAL,EAAS,KAAT,CAAD,CAAxC;AACA,QAAMQ,OAAO,GAAGL,UAAU,EAA1B;AACA,QAAMM,MAAM,GAAGL,SAAS,EAAxB;;AAEA,QAAMM,aAAa,GAAG,YAAY;AACjC,UAAMC,KAAK,CAACT,iBAAD,EAAoB;AAC9BU,MAAAA,MAAM,EAAE,MADsB;AAE9BC,MAAAA,OAAO,EAAE;AACR,wBAAgB,kBADR;AAER,8BAAuB,QAAOC,YAAY,CAACC,OAAb,CAC7B,YAD6B,CAE5B,EAJM;AAKR,8BAAuB,QAAOD,YAAY,CAACC,OAAb,CAC7B,YAD6B,CAE5B;AAPM,OAFqB;AAW9BC,MAAAA,IAAI,EAAEC,IAAI,CAACC,SAAL,CAAe;AACpBC,QAAAA,IAAI,EAAEV,MAAM,CAACU;AADO,OAAf;AAXwB,KAApB,CAAL,CAeJC,IAfI,CAeEC,GAAD,IAAS;AACd,UAAIA,GAAG,CAACC,MAAJ,KAAe,GAAnB,EAAwB;AACvBd,QAAAA,OAAO,CAACe,OAAR,CAAgB,QAAhB;AACA;AACA;;AACD,aAAOF,GAAG,CAACG,IAAJ,EAAP;AACA,KArBI,EAsBJJ,IAtBI,CAuBHK,EAAD,IAAQ;AACPlB,MAAAA,WAAW,CAAC,CAACkB,EAAE,CAACC,QAAJ,EAAcD,EAAE,CAACN,IAAjB,EAAuB,IAAvB,CAAD,CAAX;AACA,KAzBG,EA0BHQ,GAAD,IAASC,OAAO,CAACC,GAAR,CAAYF,GAAZ,CA1BL,EA4BJG,KA5BI,CA4BGH,GAAD,IAASC,OAAO,CAACC,GAAR,CAAYF,GAAZ,CA5BX,CAAN;AA6BA,GA9BD;;AA+BA5B,EAAAA,SAAS,CAAC,MAAM;AACf,QAAI,CAACe,YAAY,CAACC,OAAb,CAAqB,YAArB,CAAL,EAAyC;AACxCP,MAAAA,OAAO,CAACuB,YAAR,CAAqB,QAArB;AACA;AACA;;AACD,QAAI,CAACjB,YAAY,CAACC,OAAb,CAAqB,YAArB,CAAL,EAAyC;AACxCP,MAAAA,OAAO,CAACuB,YAAR,CAAqB,OAArB;AACA;AACA;;AACDrB,IAAAA,aAAa;AACb,GAVQ,CAAT;AAYA,sBACC;AAAA,cACEJ,QAAQ,CAAC,CAAD,CAAR,KAAgB,IAAhB,gBACA,QAAC,OAAD;AAAS,MAAA,QAAQ,EAAEA;AAAnB;AAAA;AAAA;AAAA;AAAA,YADA,gBAGA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAJF,mBADD;AASA,CAzDD;;GAAMD,W;UAEWF,U,EACDC,S;;;KAHVC,W;AA2DN,eAAeA,WAAf","sourcesContent":["import React, { useEffect, useState } from 'react'\nimport ChatBox from './../ChatBox/index'\nimport { DO_WE_NEED_RENDER } from './../../Config/index'\nimport { useHistory, useParams } from 'react-router-dom'\n\nconst ChatBoxWrap = () => {\n\tconst [userroom, setUserroom] = useState(['', '', false])\n\tconst history = useHistory()\n\tconst params = useParams()\n\n\tconst checkValidate = async () => {\n\t\tawait fetch(DO_WE_NEED_RENDER, {\n\t\t\tmethod: 'POST',\n\t\t\theaders: {\n\t\t\t\t'Content-Type': 'application/json',\n\t\t\t\t'authorization-user': `Bear ${localStorage.getItem(\n\t\t\t\t\t'token_user',\n\t\t\t\t)}`,\n\t\t\t\t'authorization-room': `Bear ${localStorage.getItem(\n\t\t\t\t\t'token_room',\n\t\t\t\t)}`,\n\t\t\t},\n\t\t\tbody: JSON.stringify({\n\t\t\t\troom: params.room,\n\t\t\t}),\n\t\t})\n\t\t\t.then((res) => {\n\t\t\t\tif (res.status === 403) {\n\t\t\t\t\thistory.replace('/login')\n\t\t\t\t\treturn\n\t\t\t\t}\n\t\t\t\treturn res.json()\n\t\t\t})\n\t\t\t.then(\n\t\t\t\t(rs) => {\n\t\t\t\t\tsetUserroom([rs.username, rs.room, true])\n\t\t\t\t},\n\t\t\t\t(err) => console.log(err),\n\t\t\t)\n\t\t\t.catch((err) => console.log(err))\n\t}\n\tuseEffect(() => {\n\t\tif (!localStorage.getItem('token_user')) {\n\t\t\thistory.replaceState('/login')\n\t\t\treturn\n\t\t}\n\t\tif (!localStorage.getItem('token_room')) {\n\t\t\thistory.replaceState('/room')\n\t\t\treturn\n\t\t}\n\t\tcheckValidate()\n\t})\n\n\treturn (\n\t\t<>\n\t\t\t{userroom[2] === true ? (\n\t\t\t\t<ChatBox userroom={userroom} />\n\t\t\t) : (\n\t\t\t\t<h1>Loading.....</h1>\n\t\t\t)}\n\t\t</>\n\t)\n}\n\nexport default ChatBoxWrap\n"]},"metadata":{},"sourceType":"module"}